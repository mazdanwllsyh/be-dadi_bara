import{r as l,d as T,u as G,j as e,C as N,D as h,E as d,ap as g,J as L,U as w,a5 as M,aq as E,a3 as a,S as F,y as c}from"./vendor-Cul97NbA.js";import{A as U,U as O,i as _}from"./index-STTFwuxj.js";const z=()=>{const{data:j}=l.useContext(U),{user:s,setUser:A}=l.useContext(O),D=T(),S=G(),[n,v]=l.useState({name:"",email:"",gender:"",phone:"",address:"",position:"",birthDate:"",education:"",interests:""}),[y,B]=l.useState(""),[m,P]=l.useState(""),[x,p]=l.useState(""),[H,W]=l.useState(!1),[b,C]=l.useState(!1),I=()=>{s||D("/login",{state:{background:S}})};l.useEffect(()=>{s&&v(o=>({...o,name:s.fullName||"",email:s.email||"",phone:s.phone||"",address:s.address||"Desa Bejalen, Bejalen Barat/Timur RT 00 RW 00",gender:s.gender||""}))},[s]),l.useEffect(()=>{if(m){const o=new Date(m),r=new Date;let i=r.getFullYear()-o.getFullYear();const u=r.getMonth()-o.getMonth();(u<0||u===0&&r.getDate()<o.getDate())&&i--,B(i),i<13?p("Minimal umur pendaftar adalah 13 tahun."):i>45?p("Maksimal umur pendaftar adalah 45 tahun."):p("")}},[m]);const t=o=>{const{name:r,value:i}=o.target;let u=i;r==="phone"&&i.startsWith("0")&&(u="62"+i.slice(1)),r==="birthDate"&&P(i),v(f=>({...f,[r]:u}))},K=async o=>{if(o.preventDefault(),b)return;if(!m){c.warn("Harap isi tanggal lahir Anda.");return}if(x){c.error(x);return}const r=n.address.toLowerCase(),i=r.includes("bejalen"),f=r.match(/rt\s*0?([1-9]|10)\b/)!==null,q=r.match(/rw\s*0?([1-4])\b/)!==null;if(!i){c.error("Alamat tidak valid. Pastikan Alamat asli anda adalah 'Bejalen'.");return}if(!f){c.error("Format RT tidak valid. Pastikan RT 1 sampai 10.");return}if(!q){c.error("Format RW tidak valid. Pastikan RW 01 sampai 04.");return}if(s?.hasRegistered){c.info("Anda sudah terdaftar, tunggu kabar dari kami.");return}C(!0);try{const k={...n,birthDate:m};await _.post("/pendaftaran",k),c.success("Pendaftaran berhasil! Kami akan segera menghubungi Anda."),A(R=>({...R,hasRegistered:!0}))}catch(k){c.error(k.response?.data?.message||"Gagal mendaftar. Silakan coba lagi.")}finally{C(!1)}};return s&&(s.role==="admin"||s.role==="superAdmin")?e.jsx("div",{className:"vh-100 d-flex justify-content-center align-items-center",children:e.jsx(N,{children:e.jsx(h,{className:"justify-content-center",children:e.jsx(d,{md:8,lg:6,children:e.jsxs(g,{variant:"info",className:"text-center shadow p-4",children:[e.jsx(g.Heading,{as:"h3",className:"section-title text-danger",children:"Akses Tidak Diperlukan"}),e.jsxs("p",{className:"section-subtitle my-3",children:['Anda sudah menjadi bagian dari "',j.namaOrganisasi,'".']}),e.jsx("hr",{}),e.jsx(L,{as:w,to:"/admin",variant:"outline-secondary",children:"Kembali ke Dashboard"})]})})})})}):s?.hasRegistered?e.jsx("div",{className:"vh-100 d-flex justify-content-center align-items-center",children:e.jsx(N,{children:e.jsx(h,{className:"justify-content-center",children:e.jsx(d,{md:8,lg:6,children:e.jsxs(g,{variant:"success",className:"text-center shadow-sm p-4",children:[e.jsx(g.Heading,{as:"h3",className:"section-title",children:"Terima Kasih!"}),e.jsxs("p",{className:"section-subtitle my-3",children:["Anda sudah terdaftar sebagai calon anggota.",e.jsx("br",{}),"Kami akan segera menghubungi Anda untuk informasi lebih lanjut."]}),e.jsx("hr",{}),e.jsx(w,{to:"/",className:"btn btn-outline-success",children:"Kembali ke Beranda"})]})})})})}):e.jsx("section",{id:"userprofile",className:"d-flex my-4 align-items-center justify-content-center",children:e.jsx(N,{children:e.jsx(h,{className:"justify-content-center",children:e.jsx(d,{xs:12,lg:8,className:"order-lg-3",children:e.jsxs(M,{className:"p-4 shadow",children:[e.jsxs(E,{className:"d-flex align-items-center justify-content-center",children:[e.jsx("img",{src:j.logoDadiBara,alt:"Logo",width:"100",className:"me-3"}),e.jsxs("h2",{className:"section-title mb-0",children:["Formulir Pendaftaran",e.jsx("br",{}),"Karang Taruna ",j.namaOrganisasi]})]}),e.jsxs(a,{onSubmit:K,className:"my-2",children:[e.jsxs(a.Group,{className:"mb-3",controlId:"formName",children:[e.jsx(a.Label,{children:"Nama Lengkap:"}),e.jsx(a.Control,{type:"text",name:"name",value:n.name,onChange:t,minLength:5,required:!0})]}),e.jsxs(h,{children:[e.jsx(d,{xs:12,md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formEmail",children:[e.jsx(a.Label,{children:"Email:"}),e.jsx(a.Control,{type:"email",name:"email",value:n.email,placeholder:s?"":"Klik di sini untuk Login",onChange:t,required:!0,readOnly:!0,onClick:I,style:{cursor:s?"not-allowed":"pointer"}})]})}),e.jsx(d,{xs:12,md:6,children:e.jsxs(a.Group,{className:"mb-3",controlId:"formPhone",children:[e.jsx(a.Label,{children:"Nomor Telepon: (yang bisa dihubungi)"}),e.jsx(a.Control,{type:"tel",name:"phone",value:n.phone,onChange:t,minLength:10,required:!0,placeholder:"selalu awali dengan 62"})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formGender",children:[e.jsx(a.Label,{children:"Jenis Kelamin:"}),e.jsxs(a.Select,{name:"gender",value:n.gender,onChange:t,className:"form-select w-100 text-center",required:!0,children:[e.jsx("option",{selected:!0,disabled:!0,value:"",children:"-- Pilih Jenis Kelamin Anda --"}),e.jsx("option",{value:"Laki-laki",children:"Laki-laki"}),e.jsx("option",{value:"Perempuan",children:"Perempuan"})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formAddress",children:[e.jsx(a.Label,{children:"Alamat Lengkap:"}),e.jsx(a.Control,{as:"textarea",rows:3,name:"address",value:n.address,onChange:t,minLength:15,required:!0})]}),e.jsxs(h,{className:"mb-3",children:[e.jsx(d,{md:6,children:e.jsxs(a.Group,{controlId:"formBirthDate",children:[e.jsx(a.Label,{children:"Tanggal Lahir:"}),e.jsx(a.Control,{type:"date",name:"birthDate",value:m,onChange:t,className:"form-control",required:!0})]})}),e.jsx(d,{md:6,children:e.jsxs(a.Group,{controlId:"formAge",className:"mt-md-0 mt-3",children:[e.jsx(a.Label,{children:"Umur: (terisi otomatis)"}),e.jsx(a.Control,{type:"text",name:"age",value:y?`${y} tahun`:"",readOnly:!0,className:"form-control",required:!0}),x&&e.jsx(a.Text,{className:"text-danger-emphasis",children:x})]})})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formEducation",children:[e.jsx(a.Label,{children:"Pendidikan Terakhir:"}),e.jsxs(h,{children:[e.jsxs(d,{md:6,className:"mb-0",children:[e.jsx(a.Check,{type:"radio",name:"education",id:"sd",label:"Sekolah Dasar",value:"sd",checked:n.education==="sd",onChange:t,required:!0}),e.jsx(a.Check,{type:"radio",name:"education",id:"smp",label:"Sekolah Menengah Pertama",value:"smp",checked:n.education==="smp",onChange:t,required:!0})]}),e.jsxs(d,{md:6,children:[e.jsx(a.Check,{type:"radio",name:"education",id:"smak",label:"Sekolah Menengah Atas / Kejuruan",value:"smak",checked:n.education==="smak",onChange:t,required:!0}),e.jsx(a.Check,{type:"radio",name:"education",id:"kuliah",label:"Universitas atau Sekolah Tinggi",value:"kuliah",checked:n.education==="kuliah",onChange:t,required:!0})]})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formPosition",children:[e.jsx(a.Label,{children:"Posisi yang Ingin Didaftar:"}),e.jsxs(a.Select,{name:"position",value:n.position,onChange:t,className:"form-select w-100 text-center",required:!0,children:[e.jsx("option",{disabled:!0,selected:!0,value:"",children:"-- Pilih Posisi --"}),e.jsx("option",{value:"ketua",className:"text-center",children:"Ketua"}),e.jsx("option",{value:"sekretaris",className:"text-center",children:"Sekretaris"}),e.jsx("option",{value:"bendahara",className:"text-center",children:"Bendahara"}),e.jsx("option",{value:"bidang_rohani",className:"text-center",children:"Bidang Kerohanian"}),e.jsx("option",{value:"bidang_umum",className:"text-center",children:"Bidang Kesekretariatan & Umum"}),e.jsx("option",{value:"bidang_humas",className:"text-center",children:"Bidang Hubungan Masyarakat"}),e.jsx("option",{value:"bidang_tekno",className:"text-center",children:"Bidang Teknologi & Informasi"}),e.jsx("option",{value:"bidang_sosbud",className:"text-center",children:"Bidang Sosial & Budaya"}),e.jsx("option",{value:"bidang_olahraga",className:"text-center",children:"Bidang Olahraga & Kepemudaan"}),e.jsx("option",{value:"anggota",className:"text-center",children:"Anggota"})]})]}),e.jsxs(a.Group,{className:"mb-3",controlId:"formInterests",children:[e.jsxs(a.Label,{children:["Minat dan Bakat ",e.jsx("b",{children:"(Opsional)"}),":"]}),e.jsx(a.Control,{as:"textarea",rows:2,name:"interests",value:n.interests,onChange:t})]}),e.jsx("div",{className:"text-center justify-content-center mt-4",children:e.jsx(L,{type:"submit",variant:"primary",className:"w-50 section-subtitle",disabled:b||!!x,children:b?e.jsx(F,{as:"span",animation:"border",size:"sm",role:"status","aria-hidden":"true"}):"Kirim Pendaftaran"})})]})]})})})})})};export{z as default};
