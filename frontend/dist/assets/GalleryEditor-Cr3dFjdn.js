import{r as t,j as e,a3 as r,a5 as f,aG as me,h as ue,S as R,y as c,a7 as he,aH as Q,J as j,ah as xe,aI as pe,C as ge,D as z,E as g,a8 as h,aa as je,I as H,an as be,aD as fe,ao as we,aE as ye,aC as Ce}from"./vendor-Cul97NbA.js";import{U as ve,A as Ne,i as b}from"./index-STTFwuxj.js";import{u as Se,D as ke}from"./usePagination-D2N1ObOo.js";import{u as Ie}from"./useCustomSwals-CUxdPQJE.js";const Ee=()=>{const{user:x}=t.useContext(ve),{theme:M}=t.useContext(Ne),[u,w]=t.useState([]),[m,y]=t.useState(!0),[o,A]=t.useState(""),[I,E]=t.useState(window.innerWidth<992);t.useEffect(()=>{const a=()=>{E(window.innerWidth<992)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]);const L={tableWrapper:{style:{borderRadius:"12px",overflow:"hidden",overflowX:I?"auto":"hidden"}},headRow:{style:{backgroundColor:"rgb(172, 172, 172)",borderBottom:"2px solid #dee2e6"}},headCells:{style:{color:"black",fontFamily:"SF UI Display",fontSize:"1.2rem",fontWeight:"bold",justifyContent:"center",borderRight:"1px solid #dee2e6","&:first-of-type":{borderLeft:"1px solid #dee2e6"}}},rows:{style:{borderBottom:"1px solid #dee2e6","&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}}},cells:{style:{fontSize:"14px",borderRight:"1px solid #dee2e6","&:first-of-type":{borderLeft:"1px solid #dee2e6"},justifyContent:"center",alignItems:"center",padding:"12px"}},pagination:{style:{justifyContent:"flex-end",padding:"10px 0",borderTop:"1px solid #dee2e6"}},noData:{style:{display:"flex",alignItems:"center",justifyContent:"center",color:"var(--bs-secondary-color)",backgroundColor:"var(--bs-body-bg)",padding:"24px"}},subHeader:{style:{display:"flex",color:"var(--bs-secondary-color)",backgroundColor:"var(--bs-body-bg)"}},progressComponent:{style:{display:"flex",color:"var(--bs-secondary-color)",backgroundColor:"var(--bs-body-bg)"}}},C=t.useMemo(()=>u.filter(a=>a.message.toLowerCase().includes(o.toLowerCase())||a.user?.fullName.toLowerCase().includes(o.toLowerCase())),[u,o]),F=async()=>{y(!0);try{const a=await b.get("/testimonials/admin",{withCredentials:!0});w(a.data.testimonials)}catch(a){c.error(a.response?.data?.message||"Gagal memuat data testimoni.")}finally{y(!1)}};t.useEffect(()=>{(x?.role==="admin"||x?.role==="superAdmin")&&F()},[x]);const D=async a=>{try{await b.patch(`/testimonials/${a}/archive`,{},{withCredentials:!0}),c.success("Status testimoni berhasil diubah!"),F()}catch{c.error("Gagal mengubah status testimoni.")}},P=[{name:"#",selector:(a,N)=>N+1,width:"50px"},{name:"Nama",selector:a=>a.user?.fullName||"Пользователи 不 NEIN",sortable:!0,width:"180px"},{name:"Rating",selector:a=>a.rating,sortable:!0,cell:a=>e.jsx("div",{children:[...Array(5)].map((N,l)=>e.jsx(he,{color:l<a.rating?"gold":"#e4e5e9"},l))})},{name:"Pesan",selector:a=>a.message,grow:2,wrap:!0,width:"500px",style:{textAlign:"justify",justifyContent:"flex-start"}},{name:"Waktu",selector:a=>ue(a.createdAt).format("DD/MM/YY HH:mm"),sortable:!0,width:"150px"},{name:"Status",selector:a=>a.isArchived,sortable:!0,cell:a=>a.isArchived?e.jsx(Q,{bg:"secondary",children:"Diarsipkan"}):e.jsx(Q,{bg:"success",children:"Aktif"})},{name:"Aksi",width:"150px",cell:a=>e.jsx(j,{variant:a.isArchived?"info":"secondary",size:"sm",onClick:()=>D(a._id),children:a.isArchived?e.jsxs(e.Fragment,{children:[e.jsx(xe,{className:"me-1"})," Aktifkan"]}):e.jsxs(e.Fragment,{children:[e.jsx(pe,{className:"me-1"})," Arsipkan"]})})}],i=[{when:a=>a.isArchived,style:{opacity:.6}}],v=t.useMemo(()=>e.jsx(r.Control,{type:"search",placeholder:"Cari Nama atau Pesan...",value:o,onChange:a=>A(a.target.value),style:{maxWidth:"250px"}}),[o]);return e.jsxs(f,{className:"shadow-sm mt-4",children:[e.jsx(f.Header,{children:e.jsx("h3",{className:"section-title mb-0",children:"Manajemen Testimoni"})}),e.jsx(f.Body,{className:"p-3",children:e.jsx(me,{columns:P,data:C,customStyles:L,pagination:!0,paginationPerPage:5,paginationRowsPerPageOptions:[5,12,30,75,100],paginationComponentOptions:{rowsPerPageText:"Baris per halaman:",rangeSeparatorText:"dari"},progressPending:m,subHeader:!0,subHeaderComponent:v,subHeaderAlign:"right",progressComponent:e.jsx("div",{className:"my-5",children:e.jsx(R,{})}),conditionalRowStyles:i,highlightOnHover:!0,noDataComponent:e.jsxs("div",{className:"text-center my-5",children:[e.jsx("h3",{className:"SF-UIDisplay text-danger",children:"Tidak Ada Data untuk Ditampilkan"}),e.jsx("p",{children:"Saat ini belum ada data yang tersedia di dalam tabel ini."})]})})})]})},He=()=>{const[x,M]=t.useState([]),[u,w]=t.useState(null),[m,y]=t.useState({_id:null,src:"",title:"",description:""}),[o,A]=t.useState(""),[I,E]=t.useState(!1),[L,C]=t.useState(!1),{showConfirmSwal:F,showSuccessSwal:D,showErrorSwal:P}=Ie(),[i,v]=t.useState(1),[a,N]=t.useState(3),[l,p]=t.useState(null),[U,V]=t.useState(""),[_,B]=t.useState(""),[W,O]=t.useState(""),[$,T]=t.useState(null),[ee,J]=t.useState(!0),[X,se]=t.useState(window.innerWidth<992),[Le,Fe]=t.useState(!1),[Pe,Ae]=t.useState(!1),ae=5*1024*1024,S=t.useCallback(async()=>{J(!0);try{const s=await b.get("/gallery");M(s.data)}catch{c.error("Gagal memuat gambar galeri.")}finally{J(!1)}},[]);t.useEffect(()=>{S();const s=()=>se(window.innerWidth<992);return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[S]);const te=s=>{w(s._id),y({...s}),T(s.src),p(null)},ne=()=>{w(null),T(null),p(null)},re=s=>{const n=s.target.files[0];if(n){if(n.size>ae){c.error("Ukuran file tidak boleh melebihi 5MB."),s.target.value=null;return}p(n),T(URL.createObjectURL(n))}},Y=s=>{const{name:n,value:G}=s.target;y({...m,[n]:G})},ie=async()=>{if(C(!0),l&&l.size>5*1024*1024){c.error("Gagal menyimpan. Ukuran file melebihi 5MB."),C(!1);return}const s=new FormData;s.append("title",m.title),s.append("description",m.description),l&&s.append("image",l);try{await b.put(`/gallery/${m._id}`,s,{withCredentials:!0}),c.success("Gambar berhasil diperbarui!"),S(),w(null),p(null)}catch{c.error("Gagal memperbarui gambar.")}finally{C(!1)}},le=async s=>{if(await F("Yakin ingin menghapus?","Apakah Anda yakin ingin menghapus Gambar dari Galeri?"))try{await b.delete(`/gallery/${s}`,{withCredentials:!0}),D("Gambar berhasil dihapus."),S()}catch{P("Gagal menghapus gambar.")}},oe=async s=>{s.preventDefault(),E(!0);const n=new FormData;if(n.append("title",_),n.append("description",W),l)n.append("image",l);else if(U)n.append("src",U);else{P("Harap pilih file .jpg .png.");return}try{await b.post("/gallery",n,{withCredentials:!0}),c.success("Gambar berhasil ditambahkan!"),S(),p(null),V(""),B(""),O("")}catch{c.error("Gagal menambahkan gambar. Periksa Ukurannya!")}finally{E(!1)}},q=t.useMemo(()=>x.filter(s=>s.title.toLowerCase().includes(o.toLowerCase())||s.description&&s.description.toLowerCase().includes(o.toLowerCase())),[o,x]),d=Se({currentPage:i,totalCount:q.length,siblingCount:1,pageSize:a}),Z=i*a,K=Z-a,ce=q.slice(K,Z),de={maxWidth:X?"100%":"60%",maxHeight:"250px",objectFit:"cover"},k=s=>v(s);return ee?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"90vh"},children:e.jsx(R,{animation:"border"})}):e.jsxs(ge,{className:"dashboard-container my-4",children:[e.jsxs(f,{className:"shadow",children:[e.jsx(f.Header,{children:e.jsx("h5",{className:"mb-0 section-title",children:"Manajemen Galeri"})}),e.jsxs(f.Body,{className:"p-3",children:[e.jsxs(z,{className:"justify-content-between align-items-center mb-3 g-3",children:[e.jsx(g,{xs:12,md:"auto",className:"order-1",children:e.jsxs("div",{className:"d-flex justify-content-center justify-content-md-start align-items-center",children:[e.jsx(r.Label,{className:"mb-0 me-2",children:"Tampilkan"}),e.jsxs(r.Select,{value:a,onChange:s=>{N(Number(s.target.value)),v(1)},style:{width:"80px"},children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:25,children:"25"}),e.jsx("option",{value:50,children:"50"})]}),e.jsx("span",{className:"ms-2",children:"entri"})]})}),e.jsx(g,{xs:12,md:5,lg:4,className:"order-2 order-md-3",children:e.jsx(r.Control,{type:"search",placeholder:"Cari judul atau deskripsi...",value:o,onChange:s=>{A(s.target.value),v(1)}})}),e.jsx(g,{xs:12,md:!0,className:"order-3 order-md-2 d-flex justify-content-center",children:d&&d.length>1&&e.jsxs(h,{className:"mb-0",children:[e.jsx(h.First,{onClick:()=>k(1),disabled:i===1}),e.jsx(h.Prev,{onClick:()=>k(i-1),disabled:i===1}),d.map((s,n)=>s===ke?e.jsx(h.Ellipsis,{disabled:!0},`dots-${n}`):e.jsx(h.Item,{active:s===i,onClick:()=>k(s),children:s},s)),e.jsx(h.Next,{onClick:()=>k(i+1),disabled:i===d[d.length-1]}),e.jsx(h.Last,{onClick:()=>k(d[d.length-1]),disabled:i===d[d.length-1]})]})})]}),e.jsxs(je,{striped:!0,bordered:!0,hover:!0,responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"th-short",children:"#"}),e.jsx("th",{children:"Pratinjau"}),e.jsx("th",{children:"Judul"}),e.jsx("th",{className:"th-long",children:"Deskripsi"}),e.jsx("th",{className:"w-auto",children:"Aksi"})]})}),e.jsx("tbody",{children:ce.map((s,n)=>e.jsxs("tr",{children:[e.jsx("td",{className:"align-middle text-center",children:K+n+1}),e.jsx("td",{className:"align-middle text-center",children:u===s._id?e.jsxs(e.Fragment,{children:[$&&e.jsx(H,{src:$,alt:"Pratinjau baru",style:{maxWidth:"100px",maxHeight:"80px",objectFit:"cover"}}),e.jsx(r.Control,{type:"file",size:"sm",className:"mt-2",onChange:re})]}):e.jsx(H,{src:s.src,alt:s.title,style:{maxWidth:"100px",maxHeight:"80px",objectFit:"cover"}})}),e.jsx("td",{className:"align-middle text-center",children:u===s._id?e.jsx(r.Control,{type:"textarea",name:"title",value:m.title,onChange:Y,className:"w-100"}):s.title}),e.jsx("td",{className:"align-middle text-center",children:u===s._id?e.jsx(r.Control,{as:"textarea",name:"description",value:m.description,onChange:Y,rows:3,className:"w-100"}):s.description}),e.jsx("td",{className:"align-middle text-center",children:u===s._id?e.jsxs("div",{className:"d-flex flex-column gap-2",children:[e.jsx(j,{variant:"success",onClick:ie,className:"w-100",size:"sm",disabled:L,children:L?e.jsx(R,{size:"sm"}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"me-1"})," Simpan"]})}),e.jsxs(j,{variant:"secondary",onClick:ne,className:"w-100",size:"sm",children:[e.jsx(fe,{className:"me-1"})," Batal"]})]}):e.jsxs("div",{className:"d-flex flex-column gap-2",children:[e.jsxs(j,{variant:"warning",size:"sm",onClick:()=>te(s),className:"w-100 d-flex align-items-center justify-content-center",children:[e.jsx(we,{className:"me-2"})," Edit"]}),e.jsxs(j,{variant:"danger",size:"sm",onClick:()=>le(s._id),className:"w-100 d-flex align-items-center justify-content-center",children:[e.jsx(ye,{className:"me-2"})," Hapus"]})]})})]},s._id))})]}),e.jsx("h3",{className:"mt-4 mb-3 text-custom text-center fw-bold",children:"Tambah Gambar Baru"}),e.jsxs(r,{onSubmit:oe,children:[l&&e.jsxs("div",{className:"text-center mb-3",children:[e.jsx("p",{className:"mb-1 text-muted",children:"Pratinjau Gambar:"}),e.jsx(H,{src:URL.createObjectURL(l),alt:"Pratinjau",thumbnail:!0,style:de,className:"shadow"})]}),e.jsxs(z,{children:[e.jsx(g,{md:"6",children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{className:"text-custom fw-bold",children:"Tambah Gambar:"}),e.jsx(r.Control,{type:"file",accept:"image/*",onChange:s=>p(s.target.files[0]),required:!0})]})}),e.jsx(g,{md:"6",children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{className:"text-custom fw-bold",children:"Judul"}),e.jsx(r.Control,{type:"text",placeholder:"Masukkan judul gambar",value:_,onChange:s=>B(s.target.value),required:!0})]})})]}),e.jsx(z,{children:e.jsx(g,{md:"12",children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{className:"text-custom fw-bold",children:"Deskripsi"}),e.jsx(r.Control,{as:"textarea",rows:3,placeholder:"Masukkan deskripsi gambar",value:W,onChange:s=>O(s.target.value)})]})})}),e.jsx("div",{className:"d-flex justify-content-center",children:e.jsx(j,{type:"submit",className:"btn-success w-50 align-content-center section-subtitle text-light",disabled:I,children:I?"Menyimpan...":e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"me-2"})," Tambah Gambar"]})})})]})]})]}),e.jsx(Ee,{})]})};export{He as default};
