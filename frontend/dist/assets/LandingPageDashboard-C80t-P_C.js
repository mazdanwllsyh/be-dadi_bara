import{r as t,y as b,j as a,S as O,a5 as D,aq as $,a3 as s,D as q,E as j,a6 as ia,J as w,aC as Y,a8 as H,aa as la,an as V,aD as ca,ao as X,aE as Z,aF as W,V as _,C as oa}from"./vendor-Cul97NbA.js";import{i as y,A as da}from"./index-STTFwuxj.js";import{u as z}from"./useCustomSwals-CUxdPQJE.js";const ma=()=>{const[o,N]=t.useState([]),[f,k]=t.useState(!0),[i,K]=t.useState({nama:"",tempat:"",tanggal:"",waktu:"",keterangan:""}),P=e=>{const r=new Date(e);if(isNaN(r.getTime()))return"Tanggal tidak valid";const L={year:"numeric",month:"long",day:"numeric"};return r.toLocaleDateString("id-ID",L)},[F,v]=t.useState(!1),[m,p]=t.useState(null),[d,E]=t.useState(1),[h,T]=t.useState(3),{showConfirmSwal:A,showSuccessSwal:u,showErrorSwal:l}=z(),[c,S]=t.useState(""),C=t.useCallback(async()=>{k(!0);try{const r=(await y.get("/jadwal-kegiatan")).data||[];N(r)}catch{b.error("Gagal mengambil data jadwal kegiatan.")}finally{k(!1)}},[]);t.useEffect(()=>{C()},[C]);const G=t.useMemo(()=>[...o].sort((e,r)=>{const L=new Date(`${r.tanggal.substring(0,10)}T${r.waktu}`),Q=new Date(`${e.tanggal.substring(0,10)}T${e.waktu}`);return L-Q}),[o]),I=t.useMemo(()=>c?G.filter(e=>e.nama.toLowerCase().includes(c.toLowerCase())||e.tempat.toLowerCase().includes(c.toLowerCase())||e.keterangan&&e.keterangan.toLowerCase().includes(c.toLowerCase())):G,[c,G]);t.useEffect(()=>{d!==1&&E(1)},[c,h]);const g=(e,r=null)=>{const{name:L,value:Q}=e.target;if(!r)K({...i,[L]:Q});else{const ra=o.map(M=>M._id===r?{...M,[L]:Q}:M);N(ra)}},n=async()=>{if(i.nama&&i.tempat&&i.tanggal&&i.waktu)try{await y.post("/jadwal-kegiatan",i,{withCredentials:!0}),b.success("Kegiatan berhasil ditambahkan!"),C(),K({nama:"",tempat:"",tanggal:"",waktu:"",keterangan:""})}catch(e){b.error(e.response?.data?.message||"Gagal menambah kegiatan.")}else l("Harap isi semua kolom untuk menambahkan kegiatan.")},x=e=>{p(e)},B=()=>{C(),p(null)},aa=async e=>{v(!0);try{await y.put(`/jadwal-kegiatan/${e._id}`,e,{withCredentials:!0}),b.success("Perubahan kegiatan berhasil disimpan!"),C(),p(null)}catch(r){b.error(r.response?.data?.message||"Gagal menyimpan perubahan.")}finally{v(!1)}},ea=async e=>{if(await A("Yakin ingin menghapus?","Kegiatan ini akan dihapus!"))try{await y.delete(`/jadwal-kegiatan/${e}`,{withCredentials:!0}),u("Kegiatan berhasil dihapus."),C(),p(null)}catch(L){l(L.response?.data?.message||"Gagal menghapus kegiatan.")}},sa=e=>{T(parseInt(e.target.value)),E(1)},J=d*h,ta=J-h,na=I.slice(ta,J),U=e=>E(e),R=Math.ceil(I.length/h);return f?a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"50vh"},children:a.jsx(O,{animation:"border"})}):a.jsxs(D,{className:"shadow-sm mt-3",children:[a.jsx($,{children:a.jsx("h3",{className:"section-title mb-0",children:"Edit Jadwal Kegiatan"})}),a.jsxs(D.Body,{children:[a.jsxs(s,{children:[a.jsxs(q,{className:"mb-3",children:[a.jsxs(j,{md:6,className:"mb-2",children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Nama Kegiatan:"}),a.jsx(s.Control,{type:"text",name:"nama",value:i.nama,onChange:e=>g(e),placeholder:"Kegiatan apa yang akan dilakukan",required:!0,minLength:8})]}),a.jsxs(j,{md:6,className:"mb-2",children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Nama Tempat:"}),a.jsx(s.Control,{type:"text",name:"tempat",value:i.tempat,onChange:e=>g(e),placeholder:"dimana tempat dilakukannya kegiatan tersebut",required:!0,minLength:8})]})]}),a.jsxs(q,{className:"mb-3",children:[a.jsxs(j,{md:6,className:"mb-2",children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Tanggal Kegiatan:"}),a.jsx(s.Control,{type:"date",name:"tanggal",value:i.tanggal,onChange:e=>g(e),required:!0})]}),a.jsxs(j,{md:6,className:"mb-2",children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Waktu Kegiatan:"}),a.jsx(s.Control,{type:"time",name:"waktu",value:i.waktu,onChange:g,required:!0})]})]}),a.jsx(s.Group,{className:"mb-3",children:a.jsx(ia,{controlId:"keteranganInput",label:"Keterangan",children:a.jsx(s.Control,{as:"textarea",rows:3,name:"keterangan",value:i.keterangan,minLength:12,onChange:e=>g(e),placeholder:"Keterangan apa saja yg harus atau apa yang akan terjadi pada kegiatan tersebut"})})}),a.jsx("div",{className:"d-flex justify-content-center m-3",children:a.jsxs(w,{onClick:n,variant:"success",className:"w-50 justify-content-center section-subtitle text-light",children:[a.jsx(Y,{className:"me-2"})," Tambah Kegiatan"]})})]}),a.jsx("hr",{className:"bg-light custom-hr my-4"}),a.jsx("h3",{className:"mb-2 text-custom text-center fw-bold",children:"Daftar Kegiatan"}),a.jsxs(q,{className:"mb-3 align-items-center justify-content-between g-3",children:[a.jsx(j,{xs:12,md:"auto",className:"order-1",children:a.jsxs("div",{className:"d-flex justify-content-center justify-content-md-start align-items-center",children:[a.jsx("span",{className:"me-2",children:"Tampilkan"}),a.jsxs(s.Select,{style:{width:"80px"},value:h,onChange:sa,children:[a.jsx("option",{value:5,children:"5"}),a.jsx("option",{value:10,children:"10"}),a.jsx("option",{value:25,children:"25"}),a.jsx("option",{value:50,children:"50"}),a.jsx("option",{value:100,children:"100"})]}),a.jsx("span",{className:"ms-2",children:"entri"})]})}),a.jsx(j,{xs:12,md:5,lg:4,className:"order-2 order-md-3",children:a.jsx(s.Control,{type:"search",placeholder:"Cari kegiatan...",value:c,onChange:e=>S(e.target.value)})}),a.jsx(j,{xs:12,md:!0,className:"order-3 order-md-2 d-flex justify-content-center",children:I.length>h&&a.jsxs(H,{className:"mb-0",children:[a.jsx(H.Prev,{onClick:()=>U(d-1),disabled:d===1}),[...Array(R).keys()].map(e=>a.jsx(H.Item,{active:e+1===d,onClick:()=>U(e+1),children:e+1},e+1)),a.jsx(H.Next,{onClick:()=>U(d+1),disabled:d===R})]})})]}),a.jsx(q,{className:"justify-content-center",children:a.jsx(j,{lg:12,children:a.jsxs(la,{striped:"columns",bordered:!0,responsive:!0,className:"table-dashboard",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{style:{whiteSpace:"nowrap"},children:"Kegiatan"}),a.jsx("th",{style:{whiteSpace:"nowrap"},children:"Tempat"}),a.jsx("th",{children:"Tanggal"}),a.jsx("th",{children:"Waktu"}),a.jsx("th",{className:"th-long",children:"Keterangan"}),a.jsx("th",{style:{whiteSpace:"nowrap"},children:"Aksi"})]})}),a.jsx("tbody",{children:na.map(e=>a.jsxs("tr",{children:[a.jsx("td",{className:"align-middle text-center",style:{wordBreak:"break-word"},children:m===e._id?a.jsx(s.Control,{type:"text",name:"nama",value:e.nama,onChange:r=>g(r,e._id)}):e.nama}),a.jsx("td",{className:"align-middle text-center",style:{wordBreak:"break-word"},children:m===e._id?a.jsx(s.Control,{type:"text",name:"tempat",value:e.tempat,onChange:r=>g(r,e._id)}):e.tempat}),a.jsx("td",{className:"align-middle text-center",children:m===e._id?a.jsx(s.Control,{type:"date",name:"tanggal",value:e.tanggal?e.tanggal.substring(0,10):"",onChange:r=>g(r,e._id)}):P(e.tanggal)}),a.jsx("td",{className:"align-middle text-center",children:m===e._id?a.jsx(s.Control,{type:"time",name:"waktu",value:e.waktu,onChange:r=>g(r,e._id)}):e.waktu}),a.jsx("td",{className:"align-middle text-center",style:{wordBreak:"break-word"},children:m===e._id?a.jsx(s.Control,{as:"textarea",rows:2,name:"keterangan",value:e.keterangan,onChange:r=>g(r,e._id)}):e.keterangan}),a.jsx("td",{style:{whiteSpace:"nowrap"},children:m===e._id?a.jsxs("div",{className:"d-flex flex-column gap-2",children:[a.jsxs(w,{variant:"primary",size:"sm",onClick:()=>aa(e),disabled:F,children:[F?a.jsx(O,{size:"sm"}):a.jsx(V,{className:"me-1"})," ","Simpan"]}),a.jsxs(w,{variant:"secondary",size:"sm",onClick:B,children:[" ",a.jsx(ca,{className:"me-2"}),"Batal"]})]}):a.jsx("div",{className:"d-flex flex-column gap-2",children:a.jsxs(a.Fragment,{children:[a.jsxs(w,{variant:"warning",className:"w-100 me-1",onClick:()=>x(e._id),children:[a.jsx(X,{})," Edit"]}),a.jsxs(w,{variant:"danger",className:"w-100",onClick:()=>ea(e._id),children:[a.jsx(Z,{})," Hapus"]})]})})})]},e._id||e.nama+e.tanggal))})]})})})]})]})},ha=()=>{const[o,N]=t.useState([]),[f,k]=t.useState(!1),[i,K]=t.useState("add"),[P,F]=t.useState(null),[v,m]=t.useState(""),[p,d]=t.useState(""),[E,h]=t.useState(!0),{showConfirmSwal:T,showSuccessSwal:A,showErrorSwal:u}=z(),l=async()=>{h(!0);try{const n=await y.get("/faq");N(n.data||[])}catch{b.error("Gagal mengambil data FAQ.")}finally{h(!1)}};t.useEffect(()=>{l()},[]);const c=(n,x=null)=>{K(n),n==="edit"&&x?(m(x.question),d(x.answer),F(x._id)):(m(""),d(""),F(null)),k(!0)},S=()=>k(!1),C=n=>{const{name:x,value:B}=n.target;x==="question"?m(B):x==="answer"&&d(B)},G=async()=>{try{const n={question:v,answer:p};await y.post("/faq",n,{withCredentials:!0}),l(),b.success("FAQ berhasil ditambahkan!"),S()}catch(n){b.error(n.response?.data?.message||"Gagal menambahkan FAQ.")}},I=async()=>{try{const n={question:v,answer:p};await y.put(`/faq/${P}`,n,{withCredentials:!0}),l(),b.success("FAQ berhasil diperbarui!"),S()}catch(n){b.error(n.response?.data?.message||"Gagal mengedit FAQ.")}},g=async n=>{if(await T("Yakin ingin menghapus?","Pertanyaan dan Jawaban (FAQ) ini akan dihapus secara permanen!"))try{await y.delete(`/faq/${n}`,{withCredentials:!0}),A("Berhasil!","FAQ berhasil dihapus."),l()}catch(B){u("Gagal!",B.response?.data?.message||"Gagal menghapus FAQ.")}};return E?a.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{minHeight:"30vh"},children:a.jsx(O,{animation:"border"})}):a.jsxs(D,{className:"shadow-sm mt-3",children:[a.jsx($,{children:a.jsx("h2",{className:"section-title mb-0",children:"FAQ Editor"})}),a.jsxs(D.Body,{children:[a.jsx(W,{children:o.length>0?o.map((n,x)=>a.jsxs(W.Item,{className:"d-flex justify-content-between align-items-center",children:[a.jsxs("div",{children:[a.jsxs("strong",{className:"SF-UIDisplay",children:[x+1,". ",n.question]}),a.jsx("p",{className:"mb-2 opacity-75 text-justify mx-3",children:n.answer})]}),a.jsxs("div",{className:"d-flex flex-column gap-2",children:[a.jsxs(w,{variant:"warning",size:"sm",className:"w-100",onClick:()=>c("edit",n),children:[a.jsx(X,{})," Edit"]}),a.jsxs(w,{variant:"danger",size:"sm",className:"w-100",onClick:()=>g(n._id),children:[a.jsx(Z,{})," Hapus"]})]})]},n._id)):a.jsx("p",{className:"text-center mt-3",children:"Belum ada pertanyaan FAQ."})}),a.jsxs(_,{show:f,onHide:S,centered:!0,backdrop:"static",keyboard:!1,children:[a.jsx(_.Header,{closeButton:!0,children:a.jsx(_.Title,{className:"section-title",children:i==="add"?"Tambah FAQ Baru":"Edit FAQ"})}),a.jsx(_.Body,{children:a.jsxs(s,{children:[a.jsxs(s.Group,{className:"mb-3",children:[a.jsx(s.Label,{children:"Pertanyaan:"}),a.jsx(s.Control,{type:"text",name:"question",value:v,onChange:C,required:!0,minLength:12})]}),a.jsxs(s.Group,{className:"mb-3",children:[a.jsx(s.Label,{children:"Jawaban:"}),a.jsx(s.Control,{as:"textarea",rows:3,name:"answer",value:p,onChange:C,required:!0,minLength:35})]})]})}),a.jsxs(_.Footer,{children:[a.jsx(w,{variant:"secondary",onClick:S,children:"Batal"}),a.jsx(w,{variant:"primary",onClick:i==="add"?G:I,children:i==="add"?"Simpan Pertanyaan":"Simpan Perubahan"})]})]})]}),a.jsx(D.Footer,{className:"d-flex justify-content-center",children:o.length<5&&a.jsxs(w,{className:"w-50 section-subtitle text-light",variant:"secondary",onClick:()=>c("add"),children:[a.jsx(Y,{className:"me-2"})," Tambah Pertanyaan"]})})]})},ja=()=>{const{data:o,updateData:N}=t.useContext(da),[f,k]=t.useState({namaOrganisasi:"",tagline:"",aboutUsText:""}),[i,K]=t.useState(null),[P,F]=t.useState(null),[v,m]=t.useState(!0),[p,d]=t.useState(!1),{showSuccessSwal:E,showErrorSwal:h}=z();t.useEffect(()=>{o.namaOrganisasi!==""&&(k({namaOrganisasi:o.namaOrganisasi||"",tagline:o.tagline||"",aboutUsText:o.aboutUsParagraphs?.join(`
`)||""}),m(!1))},[o]),t.useEffect(()=>{(async()=>{if(o.namaOrganisasi==="")try{const c=(await y.get("/landing-config")).data;c&&N(c)}catch{h("Gagal mengambil data konfigurasi.")}finally{m(!1)}})()},[o.namaOrganisasi,N]);const T=u=>{const{name:l,value:c}=u.target;k(S=>({...S,[l]:c}))},A=async u=>{u.preventDefault(),d(!0);const l=new FormData;l.append("namaOrganisasi",f.namaOrganisasi),l.append("tagline",f.tagline),l.append("aboutUsParagraphs",f.aboutUsText),i&&l.append("logoDadiBara",i),P&&l.append("logoDesaBaru",P);try{const c=await y.put("/landing-config",l,{withCredentials:!0});N(c.data),E("Data berhasil diperbarui!")}catch{h("Gagal memperbarui data.")}finally{d(!1)}};return v?a.jsx("div",{className:"d-flex flex-column justify-content-center align-items-center",style:{minHeight:"90vh"},children:a.jsx(O,{})}):a.jsxs(oa,{className:"dashboard-container my-3",children:[a.jsxs(D,{className:"shadow",children:[a.jsx($,{children:a.jsx("h2",{className:"section-title mb-0",children:"Editor Halaman Utama"})}),a.jsx(D.Body,{children:a.jsxs(s,{onSubmit:A,children:[a.jsxs(q,{className:"mb-3",children:[a.jsx(j,{md:6,className:"mb-2",children:a.jsxs(s.Group,{children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Nama Organisasi:"}),a.jsx(s.Control,{type:"text",name:"namaOrganisasi",value:f.namaOrganisasi,onChange:T})]})}),a.jsx(j,{md:6,children:a.jsxs(s.Group,{children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Tagline:"}),a.jsx(s.Control,{type:"text",name:"tagline",value:f.tagline,onChange:T})]})})]}),a.jsxs(q,{className:"mb-3",children:[a.jsx(j,{md:6,className:"mb-2",children:a.jsxs(s.Group,{children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Logo Organisasi:"}),a.jsx(s.Control,{type:"file",accept:"image/*",onChange:u=>K(u.target.files[0])})]})}),a.jsx(j,{md:6,children:a.jsxs(s.Group,{children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Logo Desa:"}),a.jsx(s.Control,{type:"file",accept:"image/*",onChange:u=>F(u.target.files[0])})]})})]}),a.jsxs(s.Group,{className:"mb-3",children:[a.jsx(s.Label,{className:"text-custom fw-bold",children:"Tentang Kami (Paragraf):"}),a.jsx(s.Control,{as:"textarea",rows:6,name:"aboutUsText",value:f.aboutUsText,onChange:T,className:"text-justify"})]}),a.jsx("div",{className:"text-center",children:a.jsxs(w,{variant:"primary",type:"submit",disabled:p,className:"w-50",children:[a.jsx(V,{})," ",p?a.jsx(O,{size:"sm"}):"Simpan Perubahan"]})})]})})]}),a.jsx(ma,{}),a.jsx(ha,{})]})};export{ja as default};
