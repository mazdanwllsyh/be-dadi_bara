import{r as a,y as L,j as s,a3 as T,C as g,a5 as p,aq as H,aG as R,S as $,J as h,aO as z,aE as A}from"./vendor-Cul97NbA.js";import{S as I}from"./AppDashboard-BM33aNKS.js";import{U as B,i as x}from"./index-STTFwuxj.js";import{u as F}from"./useCustomSwals-CUxdPQJE.js";import"./ThemeSwitcher-Crmr5owH.js";const O={tableWrapper:{style:{borderRadius:"12px",overflow:"hidden"}},headRow:{style:{backgroundColor:"rgb(172, 172, 172)",borderBottom:"2px solid #dee2e6"}},headCells:{style:{color:"black",fontFamily:"SF UI Display",fontSize:"1.2rem",fontWeight:"bold",justifyContent:"center",borderRight:"1px solid #dee2e6","&:first-of-type":{borderLeft:"1px solid #dee2e6"}}},rows:{style:{borderBottom:"1px solid #dee2e6","&:hover":{backgroundColor:"rgba(0,0,0,0.04)"}}},cells:{style:{fontSize:"14px",borderRight:"1px solid #dee2e6","&:first-of-type":{borderLeft:"1px solid #dee2e6"},justifyContent:"center",alignItems:"center",padding:"12px"}},noData:{style:{display:"flex",alignItems:"center",justifyContent:"center",color:"var(--bs-secondary-color)",backgroundColor:"var(--bs-body-bg)",padding:"24px"}},pagination:{style:{justifyContent:"flex-end",padding:"10px 0",borderTop:"1px solid #dee2e6"}},subHeader:{style:{display:"flex",color:"var(--bs-secondary-color)",backgroundColor:"var(--bs-body-bg)"}},progressComponent:{style:{display:"flex",color:"var(--bs-secondary-color)",backgroundColor:"var(--bs-body-bg)"}}},V=()=>{const{user:n}=a.useContext(B),[b,i]=a.useState(!0),[d,f]=a.useState([]),{showConfirmSwal:y,showSuccessSwal:C,showErrorSwal:w}=F(),[W,j]=a.useState(window.innerWidth<992),[M,G]=a.useState(!1),[o,k]=a.useState(""),[c,_]=a.useState(!1),l=a.useCallback(async()=>{i(!0);try{const e=await x.get("/auth/users",{withCredentials:!0});f(e.data.users)}catch(e){L.error(e.response?.data?.message||"Gagal memuat data pengguna.")}finally{i(!1)}},[]);a.useEffect(()=>{n?.role==="admin"||n?.role==="superAdmin"?l():i(!1)},[n,l]),a.useEffect(()=>{const e=()=>j(window.innerWidth<992);return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);const S=async e=>{if(await y("Yakin ingin menghapus?","Pengguna ini akan dihapus secara permanen!"))try{await x.delete(`/auth/users/${e}`,{withCredentials:!0}),C("Berhasil!","Pengguna telah dihapus."),l()}catch(t){w("Gagal!",t.response?.data?.message||"Gagal menghapus pengguna.")}},v=e=>{if(!e)return"";const r=e.indexOf("@");if(r<0)return e;const t=e.substring(0,r),u=e.substring(r);if(t.length>6){const m=t.substring(0,4),U=t.substring(t.length-2);return`${m}****${U}${u}`}else return`${t.substring(0,Math.min(2,t.length))}****${u}`},N=e=>e?e.length>6?`${e.substring(0,4)}******${e.substring(e.length-3)}`:e:"-",E=a.useMemo(()=>{const e=[...d];return e.sort((r,t)=>t._id.localeCompare(r._id)),e},[d]).filter(e=>e.fullName.toLowerCase().includes(o.toLowerCase())||e.email.toLowerCase().includes(o.toLowerCase())),P=a.useMemo(()=>s.jsx(T.Control,{type:"search",placeholder:"Cari Nama atau Email...",value:o,onChange:e=>k(e.target.value),className:"mb-3",style:{maxWidth:"250px"}}),[o,c]),D=[{name:"#",selector:(e,r)=>r+1,width:"59px"},{name:"Nama",selector:e=>e.fullName,sortable:!0},{name:"Email",selector:e=>v(e.email)},{name:"No. Telepon",selector:e=>N(e.phone)},{name:"Aksi",width:"175px",cell:e=>n?.role==="superAdmin"?s.jsxs("div",{className:"d-flex flex-column gap-2",children:[s.jsxs(h,{as:"a",href:`https://wa.me/${e.phone}`,target:"_blank",size:"sm",style:{backgroundColor:"#25D366",border:"none"},disabled:!e.phone,children:[s.jsx(z,{})," Hubungi"]}),s.jsxs(h,{variant:"danger",size:"sm",onClick:()=>S(e._id),children:[s.jsx(A,{})," Hapus"]})]}):"-"}];return n?.role!=="admin"&&n?.role!=="superAdmin"?s.jsxs("div",{style:{display:"flex"},children:[s.jsx(I,{}),s.jsxs(g,{className:"d-flex flex-column justify-content-center align-items-center vh-100",children:[s.jsx("h2",{className:"text-danger",children:"Akses Ditolak"}),s.jsx("p",{children:"Anda tidak memiliki izin untuk mengakses halaman ini."})]})]}):s.jsx(g,{fluid:!0,className:"py-4 my-3",children:s.jsxs(p,{className:"shadow",children:[s.jsx(H,{children:s.jsx("h3",{className:"mb-0 section-title",children:"Data Pengguna"})}),s.jsx(p.Body,{children:s.jsx(R,{columns:D,data:E,customStyles:O,pagination:!0,paginationResetDefaultPage:c,paginationPerPage:10,paginationRowsPerPageOptions:[15,30,60,100],subHeader:!0,subHeaderComponent:P,subHeaderAlign:"right",progressPending:b,progressComponent:s.jsx("div",{className:"my-4 bg-transparent",children:s.jsx($,{})}),paginationComponentOptions:{rowsPerPageText:"Baris per halaman:",rangeSeparatorText:"dari"},highlightOnHover:!0,pointerOnHover:!0,noDataComponent:s.jsxs("div",{className:"text-center my-5",children:[s.jsx("h3",{className:"SF-UIDisplay text-danger",children:"Tidak Ada Data untuk Ditampilkan"}),s.jsx("p",{children:"Saat ini belum ada Nama atau Email yang ada di dalam tabel ini."})]})})})]})})};export{V as default};
